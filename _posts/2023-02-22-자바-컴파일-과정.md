---

layout: post
title: "[Java] 자바 컴파일 과정"
tags: [study, cs, java]

---

## 프로그램이 실행되는 과정

> 컴파일 타임 환경

1. **자바 코드 작성(.java)**

2. **자바 컴파일러(javac)가 자바 소스를 컴파일 -> 바이트 코드(.class)로 변환**
3. **바이트 코드(.class)를 JVM의 클래스 로더에 전달**

>  런타임 환경

4. **클래스 로더에서는 동적로딩(Dynamic Loading)을 통해 필요한 클래스들을 로딩 및 링크하여 런타임 데이터 영역(JVM의 메모리)에 올림**
   * Class Loader의 세부 동작
     * 로딩 : 바이트 코드(.class)를 로드한 뒤 메소드 영역에 저장하는 동작을 수행함. 이 과정에서 JVM 스펙에 맞는지 확인하고 Java Version을 확인함
     * 링크
       * 검증 : 읽어 들인 클래스가 자바 언어 명세(Java Language Specification) 및 JVM 명세에 명시된 대로 구성되어 있는지 검사
       * 준비 : 클래스가 필요로 하는 메모리를 할당하고, 클래스에서 정의된 필드, 메서드, 인터페이스를 나타내는 데이터 구조를 준비
       * 분석 : 심볼릭 레퍼런스를 메소드 영역에 있는 실제 레퍼런스로 변경
     * 초기화 : 클래스 변수들을 적절한 값으로 초기화함. 즉, static 필드들이 설정된 값으로 초기화

5. **실행엔진은 JVM 메모리에 올라온 바이트 코드들을 명령어 단위로 하나씩 가져와서 실행**

   * 인터프리터 : 바이트 코드 명령어를 하나씩 읽어서 해석하고 실행함. 한 개 한 개의 실행 속도는 빠르나, 전체적인 실행 속도는 느림

   * JIT(Just-In-Time) 컴파일러 : 인터프리터의 단점을 보완하기 위해 도입된 방식으로 바이트 코드 전체를 컴파일해 바이너리 코드로 변경 후, 이후에는 해당 메서드를 더 이상 인터프리팅하지 않고, 바이너리 코드로 직접 실행하는 방식. 하나씩 인터프리팅하여 실행하는 것이 아닌 바이트 코드 전체가 컴파일된 바이너리 코드를 실행하는 것이기 때문에 전체적인 실행속도는 인터프리팅 방식보다 빠름



*그림으로는 아래처럼 표현할 수 있음 [출처](https://coding-factory.tistory.com/827)*

<img src="https://blog.kakaocdn.net/dn/bXdEIg/btru3sF159q/aS1KNKZS4xGeQTnRnZuoy1/img.png" alt="JAVA 실행과정" style="zoom: 67%;" />



### 컴파일 타임과 런타임의 차이

> **컴파일 타임 : 작성한 소스코드가 컴파일 과정을 통해 기계가 읽을 수 있는 기계어로 변환되는 과정**
>
> **런타임 : 컴파일 타임 이후 프로그램이 동작되어지는 때**



<u>**컴파일타임 오류(컴파일 중 발생하는 오류)**</u>

* Syntax 오류
* Type Check 오류

**<u>런타임 오류(실행이 되어야만 확인되는 오류)</u>**

* 0 나누기 오류
* NULL 참조 오류
* 메모리 부족 오류



### JVM(Java Virtual Machine)이란?

**Java 프로그램 실행환경을 만들어주는 소프트웨어**

자바 코드를 컴파일하여 바이트 코드(.class)로 만들면 자바 가상 머신 환경에서 실행됨

JVM은 JRE(Java Runtime Environment, 자바 실행 환경)에 포함되어 있음

JVM이 있기 때문에 Java는 플랫폼 독립적인 언어가 됨
